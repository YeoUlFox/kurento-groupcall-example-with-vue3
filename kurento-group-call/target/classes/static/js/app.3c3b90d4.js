(function(){"use strict";var e={8555:function(e,n,o){var r=o(9242),i=o(3396),t=o(7139),a=o.p+"img/logo.92c29c33.png";const c=(0,i._)("img",{id:"logo",alt:"logo",src:a},null,-1),s={id:"join1"},d=(0,i._)("h1",null,"Join a Room",-1),u=(0,i._)("p",null,[(0,i._)("input",{type:"text",name:"name",value:"",id:"name",placeholder:"Username",required:""})],-1),l=(0,i._)("p",null,[(0,i._)("input",{type:"text",name:"room",value:"",id:"roomName",placeholder:"Room",required:""})],-1),f=(0,i._)("p",{class:"submit"},[(0,i._)("input",{type:"submit",name:"commit",value:"방 참여"})],-1),m=[u,l,f],p={key:0,id:"room",ref:"div_room"},v={id:"room-header"},g={id:"participants",ref:"div_participants"},h=["id"];function b(e,n,o,a,u,l){return(0,i.wg)(),(0,i.iD)(i.HY,null,[c,(0,i._)("div",s,[d,(0,i._)("form",{onSubmit:n[0]||(n[0]=(0,r.iM)((e=>a.enterRoom()),["prevent"])),"accept-charset":"UTF-8"},m,32)]),a.isInRoom?((0,i.wg)(),(0,i.iD)("div",p,[(0,i._)("h2",v,(0,t.zw)(a.roomname),1),(0,i._)("div",g,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.room.participants,(([e])=>((0,i.wg)(),(0,i.iD)("div",{key:e,id:"participant"+e},null,8,h)))),128))],512),(0,i._)("input",{type:"button",id:"button-leave",onMouseup:n[1]||(n[1]=e=>a.leaveRoom()),value:"방 나가기"},null,32)],512)):(0,i.kq)("",!0)],64)}var w=o(4870),y=o(1562);function R(){var e,n,o=new WebSocket("wss://localhost:8443/groupcall"),r={};function i(o){var i={audio:!0,video:{mandatory:{maxWidth:320,maxFrameRate:15,minFrameRate:15}}};console.log(e+" registered in room "+n);var t=new u(e);r[e]=t;var a=t.getVideoElement(),c={localVideo:a,mediaConstraints:i,onicecandidate:t.onIceCandidate.bind(t)};t.rtcPeer=new y.U.WebRtcPeerSendonly(c,(function(e){if(e)return console.error(e);this.generateOffer(t.offerToReceiveVideo.bind(t))})),o.data.forEach(s)}function t(e){s(e.name)}function a(e){console.log("Participant "+e.name+" left");var n=r[e.name];n.dispose(),delete r[e.name]}function c(e){r[e.name].rtcPeer.processAnswer(e.sdpAnswer,(function(e){if(e)return console.error(e)}))}function s(e){var n=new u(e);r[e]=n;var o=n.getVideoElement(),i={remoteVideo:o,onicecandidate:n.onIceCandidate.bind(n)};n.rtcPeer=new y.U.WebRtcPeerRecvonly(i,(function(e){if(e)return console.error(e);this.generateOffer(n.offerToReceiveVideo.bind(n))}))}function d(e){var n=JSON.stringify(e);console.log("Sending message: "+n),o.send(n)}function u(e){this.name=e,Object.defineProperty(this,"rtcPeer",{writable:!0});var n,o=document.createElement("video");o.id="video-"+e,o.autoplay=!0,o.controls=!1,console.log(n),this.getVideoElement=function(){return o},this.offerToReceiveVideo=function(n,o){if(n)return console.error("sdp offer error");console.log("Invoking SDP offer callback function");var r={id:"receiveVideoFrom",sender:e,sdpOffer:o};d(r)},this.onIceCandidate=function(n){console.log("Local candidate"+JSON.stringify(n));var o={id:"onIceCandidate",candidate:n,name:e};d(o)},this.dispose=function(){console.log("Disposing participant "+this.name),this.rtcPeer.dispose()}}this.release=function(){o.close()},o.onmessage=function(e){var n=JSON.parse(e.data);switch(console.info("Received message: "+e.data),n.id){case"existingParticipants":i(n);break;case"newParticipantArrived":t(n);break;case"participantLeft":a(n);break;case"receiveVideoAnswer":c(n);break;case"iceCandidate":r[n.name].rtcPeer.addIceCandidate(n.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}));break;default:console.error("Unrecognized message",n)}},this.register=function(o,r){e=o,n=r;var i={id:"joinRoom",name:e,room:n};d(i)},this.callResponse=function(e){"accepted"!=e.response?(console.info("Call not accepted by peer. Closing call"),stop()):y.U.processAnswer(e.sdpAnswer,(function(e){if(e)return console.error(e)}))},this.leaveRoom=function(){for(var e in d({id:"leaveRoom"}),r)r[e].dispose();o.close()}}var _={name:"Kurento_Demo",setup(){var e,n=(0,w.iH)(!1),o=(0,w.iH)(),r=(0,w.iH)();function t(){e=R(),e.register(o.value,r.value),n.value=!0}function a(){e.leaveRoom(),n.value=!1}return e=R(),(0,i.ic)((()=>{})),(0,i.Jd)((()=>{0!=e.length&&e.release()})),{username:o,roomname:r,isInRoom:n,enterRoom:t,leaveRoom:a}}},O=o(89);const k=(0,O.Z)(_,[["render",b]]);var P=k;(0,r.ri)(P).mount("#app")}},n={};function o(r){var i=n[r];if(void 0!==i)return i.exports;var t=n[r]={id:r,loaded:!1,exports:{}};return e[r].call(t.exports,t,t.exports,o),t.loaded=!0,t.exports}o.m=e,function(){o.amdO={}}(),function(){var e=[];o.O=function(n,r,i,t){if(!r){var a=1/0;for(u=0;u<e.length;u++){r=e[u][0],i=e[u][1],t=e[u][2];for(var c=!0,s=0;s<r.length;s++)(!1&t||a>=t)&&Object.keys(o.O).every((function(e){return o.O[e](r[s])}))?r.splice(s--,1):(c=!1,t<a&&(a=t));if(c){e.splice(u--,1);var d=i();void 0!==d&&(n=d)}}return n}t=t||0;for(var u=e.length;u>0&&e[u-1][2]>t;u--)e[u]=e[u-1];e[u]=[r,i,t]}}(),function(){o.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(n,{a:n}),n}}(),function(){o.d=function(e,n){for(var r in n)o.o(n,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){o.p="/"}(),function(){var e={143:0};o.O.j=function(n){return 0===e[n]};var n=function(n,r){var i,t,a=r[0],c=r[1],s=r[2],d=0;if(a.some((function(n){return 0!==e[n]}))){for(i in c)o.o(c,i)&&(o.m[i]=c[i]);if(s)var u=s(o)}for(n&&n(r);d<a.length;d++)t=a[d],o.o(e,t)&&e[t]&&e[t][0](),e[t]=0;return o.O(u)},r=self["webpackChunkkurento_demo"]=self["webpackChunkkurento_demo"]||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(8555)}));r=o.O(r)})();
//# sourceMappingURL=app.3c3b90d4.js.map